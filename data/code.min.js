class js_chart{constructor(t,i,l,e,s,h){if(this.onmouseclick=!0,this.onmousemove=!0,this.ontouchmove=!0,this.onmousedown=!0,this.onmouseup=!0,this.onkeydown=!0,this.onkeyup=!0,this.oncontext=!0,this.moveCursor="pointer",this.pointerCursor="crosshair",this.autoCursor="auto",this.downloadChartEnable=!0,this.download_png_fname="chart.png",this.download_csv_fname="data.csv",this.download_csv_listsep=";",this.axisXtxt="x",this.axisYtxt="y",this.Ymax=0,this.Ymin=0,this.axisdecimalX=0,this.axisdecimalY=2,this.margv=5,this.margh=5,this.canvasbkcol="rgba(250, 250, 255, 1)",this.canvasfrw=2,this.canvasfrcol="rgba(255, 255, 255, 1)",this.marsize=8,this.marw=2,this.drawaxis=!0,this.drawarrow=!0,this.al=18,this.aw=9,this.axcol="rgba(0,0,0,1)",this.axw=2,this.axisXdesc=!0,this.axisYdesc=!0,this.axdesccol="rgba(0,100,200,1)",this.drawXdesc=!0,this.drawYdesc=!0,this.dgroup=!0,this.drawmark=!0,this.descol="rgba(0,0,255,1)",this.descfpx=15,this.descfontmod=" italic ",this.descfont="px Courier New",this.rotdescX=!0,this.drw0x=!0,this.drw0y=!0,this.hmarshift=!1,this.Yzoom=!1,this.YonlyVisiblescale=!0,this.repeatMouseMode=!0,this.repeatPerDelay=500,this.repeatPerSlow=200,this.repeatPerSpeed=50,this.drawmesh=!0,this.meshframe=!0,this.mshcol="rgb(200,200,200, 0.7)",this.meshlw=1,this.chartzone=!1,this.chartzonecol="rgba(120, 120, 120, 1)",this.drawzone=!1,this.drawzfrm=!0,this.drwfracol="rgba(150,  0,  0, 0.5)",this.drwfilcol="rgba(250,250,250, 0.3)",this.crXYline=!0,this.crXYlineOnButton=!0,this.crXjump=!0,this.crYjumpM=!1,this.crYjumpP=!0,this.crHint=!0,this.crpointhint=!0,this.crpointfill=!0,this.crlinetomouse=!1,this.crlinetosmallhint=!0,this.crlinecol="rgb(0,0,255)",this.crlinewidth=1,this.crXlinedash=[7,7],this.crYlinedash=[7,7],this.smallhint=!0,this.hintwithctrl=!0,this.hintfillcol="rgba(150, 200, 150, 0.7)",this.hintfillhitcol="rgba(200, 200, 200, 1)",this.hintframewidth=3,this.hintrectcol="rgba(50, 50, 50, 0.7)",this.hintfpx=11,this.hintfontmod=" italic ",this.hintfont="px Courier New",this.hinttxtcol="rgb(0, 0, 50)",this.hintpointw=5,this.hintlinecol="rgba(50, 50, 50, 1)",this.hintpointfill="rgba(50, 50, 150, 0.5)",this.hintpointcolfromdraw=!0,this.hintpointlwdth=1,this.hintcolfrwdth=.5,this.hintlinetoMcol="rgba(250, 0, 0, 1)",this.hintlinetoMwidth=.5,this.hintmaxalpha=!1,this.hintdatashadow=!0,this.hintshadowcol="rgba(150, 150, 150, 0.2)",this.linecol="rgba(250, 0, 0, 0.6)",this.linewidth=2,this.linepoints=!1,this.linepointsize=4,this.linepointcol="rgba(250, 0, 0, 0.7)",this.arealine="rgb(250, 0, 250)",this.areafill="rgba(250, 0, 250, 0.3)",this.areawidth=2,this.areapoints=!1,this.areapointsize=5,this.areapointcol="rgb(250, 0, 250)",this.beziercurve=!0,this.beziercnst=3,this.bezierlvloff=3,this.barline="rgb(0, 250, 250)",this.barfill="rgba(0, 250, 250, 0.3)",this.barlw=1,this.barpoints=!1,this.barpointsize=5,this.barpointcol="rgba(0, 250, 250, 0.3)",this.barperc=.75,this.boldonover=!0,this.lineBoldAlpha=1,this.lineBoldWidth=3,this.barBoldLineWidth=3,this.barBoldAlpha=.8,this.areaBoldLineWidth=3,this.areaBoldLineAlpha=1,this.areaBoldAreaAlpha=.6,this.stairsBoldLineWidth=3,this.stairsBoldLineAlpha=1,this.hideonclick=!0,this.inactivechartboxcol="rgb(100, 100, 100)",this.bigmax=1e4,this.allmaxmin=!0,this.multimsdown=!0,this.multimsdowncnt=3,this.multimstout=1e3,this.multimsdowncol="rgba(0, 0, 0, 0.15)",this.hintselectshadow=!0,this.hintselectcol="rgba(0, 0, 0, 0.3)",this.mouseclickLR=!0,this.LRsize=1/6,this.hintzoomcol="rgba(0, 250, 0, 0.15)",this.undozoompx=20,this.movezoombymouse=!0,this.revarrowkeysinzoom=!1,this.revmousemoveinzoom=!1,this.vsOn=!0,this.vzonXaxis=!this.drawaxis,this.vzcolor=this.axdesccol,this.vzalpha=.8,this.vzwdtsm=this.axw,this.vzwdtlg=this.aw,this.legframew=1,this.legframecol="rgba(250, 250, 250, 0.7)",this.legfillcol="rgba(150, 150, 150, 0.5)",this.legpx=12,this.legfontmod=" italic ",this.legfont="px Courier New",this.legtxtcol="rgba(  0, 250, 250, 1)",this.XaxisLiveValue=!1,this.YaxisLiveValue=!1,this.liveValueback="rgba(200, 200, 200, 0.8)",this.liveValueColor="rgba(0, 0, 0, 1)",this.showAllValues=!1,this.textvalue=!0,this.textvalueoffset=1,this.formattxtvalues=!0,this.livevalfpx=12,this.livevalfontmod=" italic ",this.livevalfont="px Courier New",this.valuedecimal=2,this.zcorr=1,this.repeatMousePer=0,this.islegend=!1,this.legmarg=5,this.legpos=0,this.legstr=[],this.legtop=0,this.legleft=0,this.legbottom=0,this.legright=0,void 0===t)return-1;if(void 0===i)return-2;if(void 0===l)return-3;if(this.data=i,this.style=l,this.desc=e,void 0!==s&&(this.axisXtxt=s),void 0!==h&&(this.axisYtxt=h),this.container=t,this.ctx=null,this.ctxl2=null,this.canvas=null,this.layer2=null,this.canvas=document.createElement("canvas"),this.canvas.id="canvas",this.layer2=document.createElement("canvas"),this.layer2.id="layer2",this.canvas.style.zindex=1,this.layer2.style.zindex=2,this.canvas.style.order="1",this.layer2.style.order="2",this.layer2.style.position="absolute",this.canvas.style.position="absolute",document.getElementById(t).appendChild(this.canvas),document.getElementById(t).appendChild(this.layer2),this.ctx=this.canvas.getContext("2d"),this.ctxl2=this.layer2.getContext("2d"),this.alldatalength=0,this.datalength=0,this.from=0,this.zoom=!1,Array.isArray(this.data))for(let t=0;t<this.data.length;t++)void 0!==this.data[t]&&this.alldatalength<this.data[t].length&&(this.alldatalength=this.data[t].length);this.datalength=this.alldatalength,this.to=this.alldatalength,this.eventsactivated=!1,this.pointclicked=!1,this.xdiv=0,this.wght=0,this.barcnt=0,this.barnr=0,this.marhpx=0,this.zlvl=0,this.lvlv=this.margh+2*this.marsize*this.drawmark+this.legleft*this.islegend,this.dcorr=1,this.zoffs=0,this.aYtxt="Y",this.lft=0,this.top=0,this.rgt=0,this.bot=0,this.zerox=0,this.drt=0,this.drb=0,this.drl=0,this.drr=0,this.drv=0,this.allpoints=!1,this.marpx=0,this.marmx=0,this.marax=0,this.marpl=0,this.marmi=0,this.marall=0,this.oldMouseEv=null,this.marxdata={cnt:0,div:1},this.internal_mose_flag=!1}legend(t,i){var l,e="",s=0;function h(t,i,l,e,s,h,o,r){if(void 0===r&&(r=!0),void 0===h&&(h=5),"number"==typeof h)h={tl:h,tr:h,br:h,bl:h};else{var a={tl:0,tr:0,br:0,bl:0};for(var c in a)h[c]=h[c]||a[c]}t.beginPath(),t.moveTo(i+h.tl,l),t.lineTo(i+e-h.tr,l),t.quadraticCurveTo(i+e,l,i+e,l+h.tr),t.lineTo(i+e,l+s-h.br),t.quadraticCurveTo(i+e,l+s,i+e-h.br,l+s),t.lineTo(i+h.bl,l+s),t.quadraticCurveTo(i,l+s,i,l+s-h.bl),t.lineTo(i,l+h.tl),t.quadraticCurveTo(i,l,i+h.tl,l),t.closePath(),o&&t.fill(),r&&t.stroke()}function o(t,i,l){let e;if(void 0===t)return l;for(let l=0;l<t.length;l++)if(void 0!==t[l]&&(e=t[l].split("="))[0]==i)return e[1];return l}function r(t,i){if(void 0===t)return t;if(!t.includes("rgba"))return t;let l=t.split(",");return l[3]=i+")",l[0]+","+l[1]+","+l[2]+","+l[3]}function a(t,i,l,e){void 0!==t.style[i]&&(t.ctx.save(),t.ctx.beginPath(),t.ctx.strokeStyle="rgba(0,0,0,1)",t.ctx.fillStyle=o(t.style[i],"linecolor",o(t.style[i],"fillcolor",t.areafill)),t.ctx.lineWidth=t.hintcolfrwdth,"NO"==o(t.style[i],"visible","")&&(t.ctx.fillStyle=t.inactivechartboxcol),"YES"==o(t.style[i],"boldover","---")&&(t.ctx.lineWidth=t.hintcolfrwdth+4,t.ctx.strokeStyle=r(t.ctx.fillStyle,1),t.ctx.fillStyle=r(t.ctx.fillStyle,1)),t.ctx.globalAlpha=1,t.ctx.fillRect(l,e-t.legpx,t.legpx,t.legpx),t.ctx.rect(l,e-t.legpx,t.legpx,t.legpx),t.ctx.closePath(),t.ctx.stroke(),t.ctx.restore())}if(void 0!==this.data&&(void 0!==t||void 0!==i||0!=this.islegend)){var c=0;if(void 0===t||void 0===i){this.ctx.save(),this.ctx.beginPath(),l=this.legpx/2,this.ctx.lineWidth=this.legframew,this.ctx.strokeStyle=this.legframecol,this.ctx.fillStyle=this.legfillcol,this.ctx.font=this.legfontmod+this.legpx+this.legfont;var n=0,x=0,d=0,f=0,m=0;if(0==this.legpos||2==this.legpos){n=0;for(let t=0;t<this.legstr.length;t++)void 0!==this.data[t]&&(n++,e+=this.legstr[t]);x=(s=this.ctx.measureText(e).width+n*this.legpx*2.2-this.legpx)+2*l,d=(this.ctx.canvas.width-x)/2;var v;m=0,f=0,m=(f=0==this.legpos?this.top-2*this.legpx-this.legframew-this.legmarg:this.bot+2*this.legframew+this.legmarg)+this.legpx/.7,v=f+this.legpx/.8;let t=d+l;h(this.ctx,d,f,x,1.8*this.legpx,8,!0,!0),this.ctx.font=this.legfontmod+this.legpx+this.legfont,this.ctx.fillStyle=this.legtxtcol;for(let i=0;i<this.data.length;i++)null!=this.data[i]&&void 0!==this.data[i]&&void 0!==this.legstr[i]&&(a(this,i,t,m),t+=1.2*this.legpx,"YES"==o(this.style[i],"boldover","---")?(this.ctx.font="Bold "+this.legfontmod+this.legpx+this.legfont,this.ctx.fillStyle=o(this.style[i],"linecolor",o(this.style[i],"fillcolor",this.areafill))):(this.ctx.font=this.legfontmod+this.legpx+this.legfont,this.ctx.fillStyle=this.legtxtcol),this.ctx.fillText(this.legstr[i],t,v),t+=this.ctx.measureText(this.legstr[i]).width+1*this.legpx)}if(1==this.legpos||3==this.legpos){s=0,c=0,n=0;for(let t=0;t<this.legstr.length;t++)c=this.ctx.measureText(this.legstr[t]).width,void 0!==this.data[t]&&(n++,c>s&&(s=c));x=s+2.2*this.legpx,d=0,d=1==this.legpos?this.rgt+this.legframew+this.legmarg:this.margh+this.legframew,f=(this.ctx.canvas.height-this.legpx*(this.legstr.length+1))/2;let t=d+l;h(this.ctx,d,f,x,this.legpx*(n+1),8,!0,!0),m=f+1.5*this.legpx,this.ctx.font=this.legfontmod+this.legpx+this.legfont,this.ctx.fillStyle=this.legtxtcol;for(let i=0;i<this.data.length;i++)null!=this.data[i]&&void 0!==this.data[i]&&void 0!==this.legstr[i]&&(a(this,i,t,m),"YES"==o(this.style[i],"boldover","---")?(this.ctx.font="Bold "+this.legfontmod+this.legpx+this.legfont,this.ctx.fillStyle=o(this.style[i],"linecolor",o(this.style[i],"fillcolor",this.areafill))):(this.ctx.font=this.legfontmod+this.legpx+this.legfont,this.ctx.fillStyle=this.legtxtcol),this.ctx.fillText(this.legstr[i],t+1.2*this.legpx,m-this.legpx/5),m+=this.legpx)}this.ctx.closePath(),this.ctx.restore()}else{if(this.islegend=!0,this.legstr=i,this.legpos=t,"top"==t&&(this.legpos=0),"right"==t&&(this.legpos=1),"bottom"==t&&(this.legpos=2),"left"==t&&(this.legpos=3),this.legtop=0,this.legright=0,this.legbottom=0,this.legleft=0,this.ctx.save(),this.ctx.font=this.legfontmod+this.legpx+this.legfont,c=0,s=0,1==this.legpos||3==this.legpos)for(let t=0;t<this.legstr.length;t++)void 0!==this.data[t]&&(c=this.ctx.measureText(this.legstr[t]).width)>s&&(s=c);this.ctx.restore(),0==this.legpos&&(this.legtop=2*this.legpx+2*this.legframew+this.legmarg),1==this.legpos&&(this.legright=s+2.2*this.legpx+2*this.legframew+this.legmarg),2==this.legpos&&(this.legbottom=2*this.legpx+2*this.legframew+this.legmarg),3==this.legpos&&(this.legleft=s+2.2*this.legpx+2*this.legframew+this.legmarg);for(let t=0;t<this.legstr.length;t++)void 0!==this.legstr[t]&&null!=this.legstr[t]&&""!=this.legstr[t]||(this.legstr[t]=(t+1).toString())}}}update(t,i,l,e,s){if(void 0!==t&&null!=t&&(this.data=t),void 0!==i&&null!=i&&(this.style=i),void 0!==l&&null!=l&&(this.desc=l),void 0!==e&&null!=e&&(this.axisXtxt=e),void 0!==s&&null!=s&&(this.axisYtxt=s),this.alldatalength=0,Array.isArray(this.data))for(let t=0;t<this.data.length;t++)void 0!==this.data[t]&&this.alldatalength<this.data[t].length&&(this.alldatalength=this.data[t].length);this.datalength>this.alldatalength&&(this.from=0,this.to=this.alldatalength,this.zoom=!1),this.allpoints=!1,this.draw()}home(){if(!this.zoom)return;let t=this.to-this.from;this.from=0,this.to=t,this.draw()}end(){if(!this.zoom)return;let t=this.to-this.from;this.from=this.alldatalength-t,this.to=this.alldatalength,this.draw()}left(){this.zoom&&0!=this.from&&(this.from--,this.to--,this.draw())}right(){this.zoom&&(this.to>=this.alldatalength||(this.from++,this.to++,this.draw()))}draw_FromTo(t,i){return t<0||t>=this.alldatalength?-1:i<0||i>this.alldatalength?-1:t>i||t==i?-1:(this.from=t,this.to=i,this.zoom=!0,0==this.from&&this.to==this.alldatalength&&(this.zoom=!1),this.ctxl2.canvas.style.cursor=this.pointerCursor,void this.draw())}draw_FromCount(t,i){return t<0||t>this.alldatalength-2?-1:i<=1?-1:(t+i>this.alldatalength&&(i=this.alldatalength-t),this.from=t,this.to=t+i,this.zoom=!0,0==this.from&&this.to==this.alldatalength&&(this.zoom=!1),this.ctxl2.canvas.style.cursor=this.pointerCursor,void this.draw())}undozoom(){this.from=0,this.to=this.alldatalength,this.datalength=this.alldatalength,this.zoom=!1,this.ctxl2.canvas.style.cursor=this.autoCursor,this.draw()}clear(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctxl2.clearRect(0,0,this.ctxl2.canvas.width,this.ctxl2.canvas.height)}redraw(){this.draw()}draw(){let t=document.getElementById(this.container);this.canvas.style.left=0,this.canvas.style.top=0,this.canvas.width=t.offsetWidth,this.canvas.height=t.offsetHeight,this.layer2.style.left=0,this.layer2.style.top=0,this.layer2.width=t.offsetWidth,this.layer2.height=t.offsetHeight,this.zlvl=0,this.lvlv=this.margh+2*this.marsize*this.drawmark+this.legleft*this.islegend,this.zlvl=this.drb-this.zerox,this.lft=this.margh+this.legleft*this.islegend,this.top=this.margv+this.legtop*this.islegend,this.rgt=this.ctx.canvas.clientWidth-this.margh-this.legright*this.islegend,this.bot=this.ctx.canvas.clientHeight-this.margv-this.legbottom*this.islegend,this.zerox=0,this.drt=this.top+(this.drawaxis?1.5*this.al:0),this.drb=this.bot-this.marsize*this.drawmark,this.drl=this.lvlv,this.drr=this.rgt-(this.drawaxis?1.5*this.al:0),this.drv=this.drb-this.drt,this.make_chart()}make_chart(){let t=this,i=0,l=0,e={minv:0,maxv:0},s={cnt:0,factor:1,weight:1},h={cnt:0,factor:1,weight:1},o=0,r=0,a=0,c=0;function n(i){if(void 0===i)return{min:0,max:0};let l=1/0,e=-1/0,s=0,h=i.length;t.zoom&&!t.allmaxmin&&(s=t.from,h=t.to);for(let t=s;t<h;t++)void 0!==i[t]&&null!=i[t]&&(l=i[t]<l?i[t]:l,e=i[t]>e?i[t]:e);return{min:l,max:e}}function x(t,i){if(0==i||0==t)return{cnt:1,factor:0,weight:0,value:0};t=Math.abs(t),i=Math.abs(i);let l=1,e=0,s=0;if(t>1)do{if(e=.1,(s=Math.abs(t/(e*l)))<=i)break;if(e=.2,(s=Math.abs(t/(e*l)))<=i)break;if(e=.25,(s=Math.abs(t/(e*l)))<=i)break;if(e=.5,(s=Math.abs(t/(e*l)))<=i)break;if(e=1,(s=Math.abs(t/(e*l)))<=i)break;if(e=2,(s=Math.abs(t/(e*l)))<=i)break;if(e=2.5,(s=Math.abs(t/(e*l)))<=i)break;if(e=5,(s=Math.abs(t/(e*l)))<=i)break;l*=10}while(s>i);else{do{if(e=8,(s=Math.abs(t*l/e))>=i)break;if(e=7.5,(s=Math.abs(t*l/e))>=i)break;if(e=6,(s=Math.abs(t*l/e))>=i)break;if(e=5,(s=Math.abs(t*l/e))>=i)break;if(e=2.5,(s=Math.abs(t*l/e))>=i)break;if(e=2,(s=Math.abs(t*l/e))>=i)break;if(e=1,(s=Math.abs(t*l/e))>=i)break;l*=10}while(s<i);Math.abs(t*l/e)>i&&(8==e&&(e=1,l/=10),7.5==e&&(e=8),7==e&&(e=7.5),5==e&&(e=7),2.5==e&&(e=5),2==e&&(e=2.5),1==e&&(e=2),s=Math.abs(t*l/e)),l=1/l}return{cnt:s,factor:e,weight:l,value:e*l}}function d(t,i,l){let e;if(void 0===t)return l;for(let l=0;l<t.length;l++)if(void 0!==t[l]&&(e=t[l].split("="))[0]==i)return e[1];return l}function f(t,i){if(void 0===t)return t;if(!t.includes("rgba"))return t;let l=t.split(",");return l[3]=i+")",l[0]+","+l[1]+","+l[2]+","+l[3]}function m(e,s){if(void 0===e)return;let h=0,r=0;h=0!=l?Math.abs((t.zlvl-t.drt)/l):0,r=0!=i?Math.abs((t.drb-t.zlvl)/i):0,t.wght=Math.max(h,r);let a=d(s,"linecolor",t.linecol),c=d(s,"linewidth",t.linewidth),n="true"==d(s,"points",t.linepoints).toString(),x=d(s,"pointsize",t.linepointsize),m=d(s,"pointcolor",t.linepointcol),v="true"==d(s,"beziercurve",t.beziercurve).toString(),g=d(s,"beziercnst",t.beziercnst);null==d(s,"pointcolor",null)&&(m=f(a,.3)),"YES"==d(s,"boldover","---")&&(c=t.lineBoldWidth,a=f(a,t.lineBoldAlpha));let p="true"==d(s,"showallvalues",t.showAllValues).toString(),u=d(s,"txtvaluescolor",a),b=d(s,"dash","[]");if(""!=(b=(b=(b=b.trimLeft()).trimRight()).slice(1,-1))){let i=b.split(",");t.ctx.setLineDash(i)}else t.ctx.setLineDash([]);t.bezierlvloff>=0&&t.datalength/o>t.bezierlvloff&&(v=!1),t.ctx.strokeStyle=a,t.ctx.fillStyle=a,t.ctx.lineWidth=c;let z=!1,w=0,y=0,S=0,k=0;for(let i=0;i<t.datalength;i++){let l=void 0!==e[i+0+t.from*t.zoom]&&null!=e[i+0+t.from*t.zoom],s=void 0!==e[i+1+t.from*t.zoom]&&null!=e[i+1+t.from*t.zoom];i==t.datalength-1&&(s=!1),w=t.lvlv+i*t.marhpx/t.xdiv+t.hmarshift*(t.marhpx/2),S=l?t.zlvl-(e[i+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr:t.zlvl,l&&!z&&(t.ctx.beginPath(),s?(t.ctx.moveTo(w,S),t.ctx.lineTo(w,S)):(t.ctx.save(),t.ctx.strokeStyle=f(m,1),t.ctx.fillStyle=m,t.ctx.beginPath(),t.ctx.arc(t.lvlv+i*t.marhpx/t.xdiv+t.hmarshift*(t.marhpx/2),t.zlvl-(e[i+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr,x,0,2*Math.PI),t.ctx.stroke(),t.ctx.fill(),t.ctx.restore())),l&&s&&(v?(y=t.lvlv+(i+1)*t.marhpx/t.xdiv+t.hmarshift*(t.marhpx/2),k=t.zlvl-(e[i+1+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr,t.ctx.bezierCurveTo(w+t.marhpx/g,S,y-t.marhpx/g,k,y,k)):t.ctx.lineTo(w,S)),l&&!s&&(t.ctx.lineTo(w,S),t.ctx.stroke(),t.ctx.closePath(),t.ctx.beginPath()),!l||z||s||(i+1<t.datalength?t.ctx.lineTo(w+t.marhpx,S):(t.ctx.save(),t.ctx.strokeStyle=f(m,1),t.ctx.fillStyle=m,t.ctx.beginPath(),t.ctx.arc(t.lvlv+i*t.marhpx/t.xdiv+t.hmarshift*(t.marhpx/2),t.zlvl-(e[i+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr,x,0,2*Math.PI),t.ctx.stroke(),t.ctx.fill(),t.ctx.restore())),z=l}if(t.ctx.setLineDash([]),n||t.allpoints){t.ctx.beginPath(),void 0!==e[0+t.from*t.zoom]&&null!=e[0+t.from*t.zoom]&&(t.ctx.arc(t.lvlv+t.hmarshift*(t.marhpx/2),t.zlvl-(e[0+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr,x,0,2*Math.PI),t.ctx.stroke(),t.ctx.fill());for(let i=1;i<t.datalength;i++)void 0!==e[i+t.from*t.zoom]&&null!=e[i+t.from*t.zoom]&&(t.ctx.beginPath(),t.ctx.arc(t.lvlv+i*t.marhpx/t.xdiv+t.hmarshift*(t.marhpx/2),t.zlvl-(e[i+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr,x,0,2*Math.PI),t.ctx.stroke(),t.ctx.fill());t.ctx.closePath()}if(p){t.ctx.font=("YES"==d(s,"boldover","---")?"Bold":"")+t.descfontmod+t.descfpx+t.descfont,t.ctx.strokeStyle=u,t.ctx.fillStyle=u,t.ctx.textAlign="center",t.ctx.textBaseline="middle",t.ctx.beginPath();for(let i=0;i<t.datalength;i++){if(void 0===e[i+t.from*t.zoom]||null==e[i+t.from*t.zoom])continue;let l=e[i+t.from*t.zoom],s=l;t.formattxtvalues&&(s=l.toLocaleString(void 0,{useGrouping:t.dgroup,minimumFractionDigits:t.valuedecimal,maximumFractionDigits:t.valuedecimal}));let h=t.ctx.measureText(s).width;if(h+t.descfpx>t.marhpx)break;let o=-(e[i+t.from*t.zoom]>0?1:-1)*t.descfpx*t.textvalueoffset+t.zlvl-(e[i+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr;(o<t.drt||o>t.drb)&&(o+=2*(e[i+t.from*t.zoom]>0?1:-1)*t.descfpx*t.textvalueoffset);let r=t.lvlv+i*t.marhpx/t.xdiv+t.hmarshift*(t.marhpx/2);r-h/2-t.descfpx/2<t.lvlv&&(r=r+h/2+t.descfpx/2),r+h/2+t.descfpx/2>t.drr&&(r=r-h/2-t.descfpx/2),t.ctx.fillText(s,r,o),t.ctx.stroke(),t.ctx.fill()}t.ctx.closePath()}}function v(e,s){if(void 0===e)return;let h=0,o=0;h=0!=l?Math.abs((t.zlvl-t.drt)/l):0,o=0!=i?Math.abs((t.drb-t.zlvl)/i):0,t.wght=Math.max(h,o),t.ctx.strokeStyle=d(s,"linecolor",t.barline),t.ctx.fillStyle=d(s,"fillcolor",t.barfill),t.ctx.lineWidth=d(s,"linewidth",t.barlw);let r="true"==d(s,"points",t.barpoints).toString(),a=d(s,"pointsize",t.barpointsize),c=d(s,"pointcolor",t.barpointcol);null==d(s,"pointcolor",null)&&(c=f(t.ctx.fillStyle,.3)),"YES"==d(s,"boldover","---")&&(t.ctx.lineWidth=t.barBoldLineWidth,t.ctx.fillStyle=f(t.ctx.fillStyle,t.barBoldAlpha));let n="true"==d(s,"showallvalues",t.showAllValues).toString(),x=d(s,"txtvaluescolor",t.ctx.strokeStyle);t.ctx.beginPath();let m=!1,v=t.marhpx*t.barperc,g=v/t.barcnt;t.marxdata.div>1&&(g/=1*t.marxdata.div);let p=0,u=0;for(let i=0;i<t.datalength;i++)(m=void 0!==e[i+t.from*t.zoom]&&null!=e[i+t.from*t.zoom])&&(u=t.zlvl-(e[i+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr,p=t.lvlv+t.hmarshift*(t.marhpx/2)-g/2*t.barcnt+i*t.marhpx/t.xdiv+g*t.barnr,t.ctx.rect(p,u,g,t.zlvl-u));if(t.ctx.stroke(),t.ctx.fill(),t.ctx.closePath(),t.barnr++,r||t.allpoints){t.ctx.beginPath(),t.ctx.strokeStyle=f(c,1),t.ctx.fillStyle=c,t.ctx.stroke(),t.ctx.fill();for(let i=0;i<t.datalength;i++)void 0!==e[i+t.from*t.zoom]&&null!=e[i+t.from*t.zoom]&&(t.ctx.beginPath(),p=t.lvlv+i*t.marhpx/t.xdiv+g*t.barnr+t.hmarshift*(t.marhpx/2-v/2-g/2),u=t.zlvl-(e[i+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr,t.ctx.arc(p,u,a,0,2*Math.PI),t.ctx.stroke(),t.ctx.fill())}if(n){t.ctx.font=("YES"==d(s,"boldover","---")?"Bold":"")+t.descfontmod+t.descfpx+t.descfont,t.ctx.strokeStyle=x,t.ctx.fillStyle=x,t.ctx.textAlign="center",t.ctx.textBaseline="middle",t.ctx.beginPath();for(let i=0;i<t.datalength;i++){if(void 0===e[i+t.from*t.zoom]||null==e[i+t.from*t.zoom])continue;let l=e[i+t.from*t.zoom],s=l;t.formattxtvalues&&(s=l.toLocaleString(void 0,{useGrouping:t.dgroup,minimumFractionDigits:t.valuedecimal,maximumFractionDigits:t.valuedecimal}));let h=t.ctx.measureText(s).width;if(h+t.descfpx>t.marhpx)break;let o=t.lvlv+i*t.marhpx/t.xdiv+g*t.barnr+t.hmarshift*(t.marhpx/2-v/2-g/2),r=-(e[i+t.from*t.zoom]>0?1:-1)*t.descfpx*t.textvalueoffset+t.zlvl-(e[i+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr;(r<t.drt||r>t.drb)&&(r+=2*(e[i+t.from*t.zoom]>0?1:-1)*t.descfpx*t.textvalueoffset),o-h/2-t.descfpx/2<t.lvlv&&(o=o+h/2+t.descfpx/2),o+h/2+t.descfpx/2>t.drr&&(o=o-h/2-t.descfpx/2),t.ctx.fillText(s,o,r),t.ctx.stroke(),t.ctx.fill()}t.ctx.closePath()}}function g(e,s){if(void 0===e)return;let h=0,r=0;h=0!=l?Math.abs((t.zlvl-t.drt)/l):0,r=0!=i?Math.abs((t.drb-t.zlvl)/i):0,t.wght=Math.max(h,r);let a=d(s,"linecolor",t.arealine),c=d(s,"linewidth",t.areawidth),n=d(s,"fillcolor",t.areafill),x="true"==d(s,"points",t.areapoints).toString(),m=d(s,"pointsize",t.areapointsize),v=d(s,"pointcolor",t.areapointcol),g="true"==d(s,"beziercurve",t.beziercurve).toString(),p=d(s,"beziercnst",t.beziercnst);null==d(s,"pointcolor",null)&&(v=f(n,.3)),"YES"==d(s,"boldover","---")&&(c=t.areaBoldLineWidth,a=f(a,t.areaBoldLineWidth),n=f(n,t.areaBoldAreaAlpha));let u="true"==d(s,"showallvalues",t.showAllValues).toString(),b=d(s,"txtvaluescolor",a);t.ctx.strokeStyle=a,t.ctx.fillStyle=n,t.ctx.lineWidth=c,t.bezierlvloff>=0&&t.datalength/o>t.bezierlvloff&&(g=!1);let z=!1,w=0,y=0,S=0,k=0;for(let i=0;i<t.datalength;i++){let l=void 0!==e[i+0+t.from*t.zoom]&&null!=e[i+0+t.from*t.zoom],s=void 0!==e[i+1+t.from*t.zoom]&&null!=e[i+1+t.from*t.zoom];i==t.datalength-1&&(s=!1),w=t.lvlv+i*t.marhpx/t.xdiv+t.hmarshift*(t.marhpx/2),S=0,S=l?t.zlvl-(e[i+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr:t.zlvl,l&&!z&&(t.ctx.beginPath(),t.ctx.moveTo(w,t.zlvl),t.ctx.lineTo(w,S)),l&&s&&(g?(y=t.lvlv+(i+1)*t.marhpx/t.xdiv+t.hmarshift*(t.marhpx/2),k=t.zlvl-(e[i+1+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr,t.ctx.bezierCurveTo(w+t.marhpx/p,S,y-t.marhpx/p,k,y,k)):t.ctx.lineTo(w,S)),l&&!s&&(t.ctx.lineTo(w,S),t.ctx.lineTo(w,t.zlvl),t.ctx.stroke(),t.ctx.fill(),t.ctx.closePath(),t.ctx.beginPath()),z=l}if(x||t.allpoints){t.ctx.beginPath(),t.ctx.strokeStyle=f(v,1),t.ctx.fillStyle=v,void 0!==e[0+t.from*t.zoom]&&null!=e[0+t.from*t.zoom]&&(t.ctx.arc(t.lvlv+t.hmarshift*(t.marhpx/2),t.zlvl-(e[0+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr,m,0,2*Math.PI),t.ctx.stroke(),t.ctx.fill());for(let i=1;i<t.datalength;i++)void 0!==e[i+t.from*t.zoom]&&null!=e[i+t.from*t.zoom]&&(t.ctx.beginPath(),t.ctx.arc(t.lvlv+i*t.marhpx/t.xdiv+t.hmarshift*(t.marhpx/2),t.zlvl-(e[i+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr,m,0,2*Math.PI),t.ctx.stroke(),t.ctx.fill())}if(u){t.ctx.font=("YES"==d(s,"boldover","---")?"Bold":"")+t.descfontmod+t.descfpx+t.descfont,t.ctx.strokeStyle=b,t.ctx.fillStyle=b,t.ctx.textAlign="center",t.ctx.textBaseline="middle",t.ctx.beginPath();for(let i=0;i<t.datalength;i++){if(void 0===e[i+t.from*t.zoom]||null==e[i+t.from*t.zoom])continue;let l=e[i+t.from*t.zoom],s=l;t.formattxtvalues&&(s=l.toLocaleString(void 0,{useGrouping:t.dgroup,minimumFractionDigits:t.valuedecimal,maximumFractionDigits:t.valuedecimal}));let h=t.ctx.measureText(s).width;if(h+t.descfpx>t.marhpx)break;let o=-(e[i+t.from*t.zoom]>0?1:-1)*t.descfpx*t.textvalueoffset+t.zlvl-(e[i+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr;(o<t.drt||o>t.drb)&&(o+=2*(e[i+t.from*t.zoom]>0?1:-1)*t.descfpx*t.textvalueoffset);let r=t.lvlv+i*t.marhpx/t.xdiv+t.hmarshift*(t.marhpx/2);r-h/2-t.descfpx/2<t.lvlv&&(r=r+h/2+t.descfpx/2),r+h/2+t.descfpx/2>t.drr&&(r=r-h/2-t.descfpx/2),t.ctx.fillText(s,r,o),t.ctx.stroke(),t.ctx.fill()}t.ctx.closePath()}}function p(e,s){if(void 0===e)return;let h=0,o=0;h=0!=l?Math.abs((t.zlvl-t.drt)/l):0,o=0!=i?Math.abs((t.drb-t.zlvl)/i):0,t.wght=Math.max(h,o);let r=d(s,"linecolor",t.linecol),a=d(s,"linewidth",t.linewidth),c="true"==d(s,"points",t.linepoints).toString(),n=d(s,"pointsize",t.linepointsize),x=d(s,"pointcolor",t.linepointcol);null==d(s,"pointcolor",null)&&(x=f(r,.3)),"YES"==d(s,"boldover","---")&&(a=t.stairsBoldLineWidth,r=f(r,t.stairsBoldLineAlpha));let m="true"==d(s,"showallvalues",t.showAllValues).toString(),v=d(s,"txtvaluescolor",r);t.ctx.strokeStyle=r,t.ctx.fillStyle=r,t.ctx.lineWidth=a;let g=!1,p=0,u=0,b=0;for(let i=0;i<t.datalength;i++){let l=void 0!==e[i+0+t.from*t.zoom]&&null!=e[i+0+t.from*t.zoom],s=void 0!==e[i+1+t.from*t.zoom]&&null!=e[i+1+t.from*t.zoom];i==t.datalength-1&&(s=!1),p=t.lvlv+i*t.marhpx/t.xdiv+t.hmarshift*(t.marhpx/2),u=l?t.zlvl-(e[i+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr:t.zlvl,b=s?t.zlvl-(e[i+1+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr:u,l&&!g&&s&&(t.ctx.beginPath(),t.ctx.moveTo(p,u),t.ctx.lineTo(p+t.marhpx/t.xdiv,u)),l&&s&&(t.ctx.lineTo(p+t.marhpx/t.xdiv,u),t.ctx.lineTo(p+t.marhpx/t.xdiv,b)),l&&!s&&(i+1<t.datalength&&(t.ctx.moveTo(p,b),t.ctx.lineTo(p+t.marhpx/t.xdiv,b)),t.ctx.stroke(),t.ctx.closePath(),t.ctx.beginPath()),!l||g||s||(i+1<t.datalength?t.ctx.lineTo(p+t.marhpx/t.xdiv,u):(t.ctx.save(),t.ctx.strokeStyle=f(x,1),t.ctx.fillStyle=x,t.ctx.beginPath(),t.ctx.arc(t.lvlv+i*t.marhpx/t.xdiv+t.hmarshift*(t.marhpx/2),t.zlvl-(e[i+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr,n,0,2*Math.PI),t.ctx.stroke(),t.ctx.fill(),t.ctx.restore())),g=l}if(c||t.allpoints){t.ctx.beginPath(),t.ctx.strokeStyle=f(x,1),t.ctx.fillStyle=x,void 0!==e[0+t.from*t.zoom]&&null!=e[0+t.from*t.zoom]&&(t.ctx.arc(t.lvlv+t.hmarshift*(t.marhpx/2),t.zlvl-(e[0+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr,n,0,2*Math.PI),t.ctx.stroke(),t.ctx.fill());for(let i=1;i<t.datalength;i++)void 0!==e[i+t.from*t.zoom]&&null!=e[i+t.from*t.zoom]&&(t.ctx.beginPath(),t.ctx.arc(t.lvlv+i*t.marhpx/t.xdiv+t.hmarshift*(t.marhpx/2),t.zlvl-(e[i+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr,n,0,2*Math.PI),t.ctx.stroke(),t.ctx.fill())}if(m){t.ctx.font=("YES"==d(s,"boldover","---")?"Bold":"")+t.descfontmod+t.descfpx+t.descfont,t.ctx.strokeStyle=v,t.ctx.fillStyle=v,t.ctx.textAlign="center",t.ctx.textBaseline="middle",t.ctx.beginPath();for(let i=0;i<t.datalength;i++){if(void 0===e[i+t.from*t.zoom]||null==e[i+t.from*t.zoom])continue;let l=e[i+t.from*t.zoom],s=l;t.formattxtvalues&&(s=l.toLocaleString(void 0,{useGrouping:t.dgroup,minimumFractionDigits:t.valuedecimal,maximumFractionDigits:t.valuedecimal}));let h=t.ctx.measureText(s).width;if(h+t.descfpx>t.marhpx)break;let o=-(l>0?1:-1)*t.descfpx*t.textvalueoffset+t.zlvl-(l+t.zoffs)*t.wght*t.dcorr*t.zcorr;(o<t.drt||o>t.drb)&&(o+=2*(e[i+t.from*t.zoom]>0?1:-1)*t.descfpx*t.textvalueoffset);let r=t.lvlv+i*t.marhpx/t.xdiv+t.hmarshift*(t.marhpx/2);r-h/2-t.descfpx/2<t.lvlv&&(r=r+h/2+t.descfpx/2),r+h/2+t.descfpx/2>t.drr&&(r=r-h/2-t.descfpx/2),t.ctx.fillText(s,r,o),t.ctx.stroke(),t.ctx.fill()}t.ctx.closePath()}}function u(i){return"bar"==d(t.style[i],"type","")}function b(i){return"line"==d(t.style[i],"type","")}var z=0,w=0,y=0,S=0,k=!1,T=0,M=!1,Y=0,P=-1;function D(e){if(null==e?e=t.oldMouseEv:t.oldMouseEv=e,null==e)return;if(t.internal_mose_flag)return;if(t.boldonover){var s=L(e.offsetX,e.offsetY);if(s>=0&&s!=P)s!=P&&X(s,"boldover",!0);else for(let i=0;i<t.style.length;i++)X(i,"boldover",!1);s!=P&&(t.internal_mose_flag=!0,t.draw()),P=s}if(t.internal_mose_flag=!1,t.zoom&&t.movezoombymouse){if(2==e.buttons)return t.ctxl2.canvas.style.cursor=t.moveCursor,Y+=e.movementX,void(Math.abs(Y)>=t.marhpx&&(Y<0?t.revmousemoveinzoom?t.left():t.right():t.revmousemoveinzoom?t.right():t.left(),Y=0));t.ctxl2.canvas.style.cursor=t.pointerCursor}let h=z;if("keydown"!=e.type&&0!=e.offsetX&&0!=e.offsetY&&(z=e.offsetX,w=e.offsetY),"mousemove"==e.type&&0!=e.offsetX&&0!=e.offsetY&&(z=e.offsetX,w=e.offsetY),t.data.length<=0)return;if(t.pointclicked)return;let o=0,r=0,a=e.offsetX,c=e.offsetY;if("mousemove"!=e.type&&(a=z,c=w),t.ctxl2.clearRect(0,0,t.layer2.width,t.layer2.height),c>=t.drt-2*t.hintpointw&&c<=t.drb+2*t.hintpointw&&a>=t.drl-2*t.hintpointw&&a<=t.drr+2*t.hintpointw){if(o=Math.round((a-t.lvlv-t.hmarshift*(t.marhpx/2))/(t.marhpx/t.xdiv)),isNaN(o)||o<0||o>=t.datalength)return;let s=t.lvlv+o*t.marhpx/t.xdiv+t.hmarshift*(t.marhpx/2),x=t.LRsize*t.drv;if(t.zoom&&t.mouseclickLR&&!e.shiftKey&&(a>t.drl&&a<t.drl+x&&t.from>0&&(t.ctxl2.lineWidth=5,t.ctxl2.strokeStyle=f(t.hintzoomcol,1),t.ctxl2.fillStyle=t.hintzoomcol,t.ctxl2.beginPath(),t.ctxl2.fillRect(t.drl,t.drt,x,t.drv),t.ctxl2.stroke(),t.ctxl2.fill(),t.ctxl2.beginPath(),t.ctxl2.moveTo(t.drl+.8*x,t.drt+t.drv/2-.1*t.drv),t.ctxl2.lineTo(t.drl+.2*x,t.drt+(t.drb-t.drt)/2),t.ctxl2.lineTo(t.drl+.8*x,t.drt+t.drv/2+.1*t.drv),t.ctxl2.stroke(),t.ctxl2.closePath()),a>t.drr-x&&a<t.drr&&t.to<t.alldatalength&&(t.ctxl2.lineWidth=5,t.ctxl2.strokeStyle=f(t.hintzoomcol,1),t.ctxl2.fillStyle=t.hintzoomcol,t.ctxl2.beginPath(),t.ctxl2.fillRect(t.drr-x,t.drt,x,t.drv),t.ctxl2.stroke(),t.ctxl2.fill(),t.ctxl2.beginPath(),t.ctxl2.moveTo(t.drr-.8*x,t.drt+t.drv/2-.1*t.drv),t.ctxl2.lineTo(t.drr-.2*x,t.drt+(t.drb-t.drt)/2),t.ctxl2.lineTo(t.drr-.8*x,t.drt+t.drv/2+.1*t.drv),t.ctxl2.stroke(),t.ctxl2.closePath())),t.hintselectshadow&&e.shiftKey&&k&&1==T){S=o+t.from;let i=t.lvlv+(y-t.from)*t.marhpx/t.xdiv+t.hmarshift*(t.marhpx/2),l=s-i;l<1&&(l=t.marhpx),t.ctxl2.fillStyle=t.hintselectcol;t.marhpx;return t.ctxl2.beginPath(),i+l>t.drr&&(l=t.drr-i),y>S&&(l=0),Math.abs(t.from-t.to)>2&&t.ctxl2.fillRect(i,t.drt,l,t.drb-t.drt),t.ctxl2.stroke(),t.ctxl2.fill(),t.ctxl2.closePath(),void(a-h<-t.undozoompx&&(y=0,S=0,k=!1,t.undozoom()))}let m=!1,v=!1,g=0,p=0,Y=0,P=2*t.hintpointw,D=t.marhpx*t.barperc/t.barcnt,L=t.marhpx*t.barperc/2,X=t.lvlv+o*t.marhpx/t.xdiv+t.hmarshift*(t.marhpx/2);for(let i=0;i<t.data.length;i++)if(void 0!==t.data[i]){if(p=t.zlvl-(t.data[i][o+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr,g=X,u(i)&&(g=g-L+D*(++Y-1)),Math.abs(g-z)<P&&Math.abs(p-w)<P){v=!0;break}v=!1}if(v&&t.smallhint&&(M=!0,A(e),M=!1,m=!0),t.hintwithctrl&&!e.ctrlKey)return;if(t.ctxl2.lineWidth=t.crlinewidth,t.ctxl2.setLineDash(t.crYlinedash),t.ctxl2.strokeStyle=t.crlinecol,t.hintdatashadow&&t.barcnt>0){t.ctxl2.fillStyle=t.hintshadowcol;let i=t.marhpx/2;t.ctxl2.beginPath(),t.ctxl2.fillRect(s-i,t.drt,2*i,t.drb-t.drt),t.ctxl2.stroke(),t.ctxl2.fill(),t.ctxl2.closePath()}if(t.crXjump&&(a=s),(t.crXYline&&a>=t.drl&&a<=t.drr||t.crXYlineOnButton&&1==e.buttons)&&(t.ctxl2.beginPath(),t.ctxl2.moveTo(a,t.drb),t.ctxl2.lineTo(a,t.drt),t.ctxl2.stroke(),t.ctxl2.closePath()),t.ctxl2.setLineDash(t.crXlinedash),t.crYjumpM||t.crYjumpP){let i=0,l=0;t.crYjumpM&&(r=Math.round((c-t.zlvl)/t.marpx),c=i=t.zlvl+r*t.marpx);let e=!1;if(t.crYjumpP){let s=t.marax,h=s;for(let r=0;r<t.data.length;r++)if(e=void 0!==t.data[r]&&void 0!==t.data[r][o+t.from*t.zoom]&&null!=t.data[r][o+t.from*t.zoom]){{l=t.zlvl-(t.data[r][o+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr;let i=Math.abs(l-c);!t.crYjumpM&&i<s&&i<=h&&(h=i,c=l)}t.crYjumpM&&t.crYjumpP&&Math.abs(l-i)<s&&"NO"!=d(t.style[r],"visible","")&&(c=l)}}}if((t.crXYline&&c>=t.drt&&c<=t.drb||t.crXYlineOnButton&&1==e.buttons)&&(t.ctxl2.beginPath(),t.ctxl2.moveTo(t.drl,c),t.ctxl2.lineTo(t.drr,c),t.ctxl2.stroke(),t.ctxl2.closePath()),t.crpointhint||t.crlinetomouse||t.textvalue){let i,l,e=0,h=0;t.ctxl2.setLineDash([]);for(let r=0;r<t.data.length;r++)if(i=void 0!==t.data[r]&&void 0!==t.data[r][o+t.from*t.zoom]&&null!=t.data[r][o+t.from*t.zoom]){if(l=t.zlvl-(t.data[r][o+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr,h=0,t.crpointhint){if(t.ctxl2.lineWidth=t.hintpointlwdth,t.ctxl2.strokeStyle=t.hintlinecol,b(r)?t.hintpointcolfromdraw?(t.ctxl2.fillStyle=d(t.style[r],"linecolor",t.hintpointfill),t.ctxl2.strokeStyle=f(t.ctxl2.fillStyle,1)):(t.ctxl2.fillStyle=t.hintpointfill,t.ctxl2.strokeStyle=t.hintlinecol):t.hintpointcolfromdraw?(t.ctxl2.fillStyle=d(t.style[r],"fillcolor",t.hintpointfill),t.ctxl2.strokeStyle=f(t.ctxl2.fillStyle,1)):(t.ctxl2.fillStyle=t.hintpointfill,t.ctxl2.strokeStyle=t.hintlinecol),t.hintmaxalpha&&(t.ctxl2.fillStyle=f(t.ctxl2.fillStyle,1)),u(r)){let i=t.marhpx*t.barperc/t.barcnt;t.marxdata.div>1&&(i/=1*t.marxdata.div),h=-i/1*e+(t.barcnt-1)*i/2,e++}if("NO"==d(t.style[r],"visible","---"))continue;t.ctxl2.beginPath(),t.ctxl2.arc(s-h,l,t.hintpointw,0,2*Math.PI),t.ctxl2.stroke(),t.crpointfill&&t.ctxl2.fill()}if(t.textvalue){if("NO"==d(t.style[r],"visible","---"))continue;t.ctxl2.fillStyle=d(t.style[r],"txtvaluescolor",d(t.style[r],"linecolor",t.hintpointfill)),t.ctxl2.font=t.livevalfontmod+t.livevalfpx+t.livevalfont,t.ctxl2.beginPath(),t.ctxl2.textAlign="center",t.ctxl2.textBaseline="middle";let i=t.data[r][o+t.from*t.zoom];t.formattxtvalues&&(i=i.toLocaleString(void 0,{useGrouping:t.dgroup,minimumFractionDigits:t.valuedecimal,maximumFractionDigits:t.valuedecimal}));let e=l-(t.data[r][o+t.from*t.zoom]>0?1:-1)*t.descfpx*t.textvalueoffset;(e<t.drt||e>t.drb)&&(e=l+(t.data[r][o+t.from*t.zoom]>0?1:-1)*t.descfpx*t.textvalueoffset);let a=s-h,c=t.ctx.measureText(i).width;a-c/2-t.descfpx/2<t.lvlv&&(a=a+c/2+t.descfpx/2),a+c/2+t.descfpx/2>t.drr&&(a=a-c/2-t.descfpx/2),t.ctxl2.fillText(i,a,e)}t.crlinetomouse&&(t.ctxl2.lineWidth=t.hintlinetoMwidth,t.ctxl2.strokeStyle=t.hintlinetoMcol,t.ctxl2.beginPath(),t.ctxl2.moveTo(s-h,l),t.ctxl2.lineTo(z,w),t.ctxl2.stroke())}}if(t.crHint&&!m){t.ctxl2.setLineDash([]),t.ctxl2.font=t.hintfontmod+t.hintfpx+t.hintfont;let i=[],l=0,e=0,s="";s="number"==typeof t.desc[o+t.from*t.zoom]?t.axisXtxt+" = "+t.desc[o+t.from*t.zoom].toLocaleString(void 0,{useGrouping:t.dgroup,minimumFractionDigits:t.axisdecimalX,maximumFractionDigits:t.axisdecimalX}):t.axisXtxt+" = "+t.desc[o+t.from*t.zoom];let h,r,a="";l=t.ctxl2.measureText(s).width;for(let s=0;s<t.data.length;s++)"NO"!=d(t.style[s],"visible","---")&&(void 0!==t.data[s]&&void 0!==t.data[s][o+t.from*t.zoom]&&null!=t.data[s][o+t.from*t.zoom]?i.push((t.data[s][o+t.from*t.zoom]*t.dcorr).toLocaleString(void 0,{useGrouping:t.dgroup,minimumFractionDigits:t.valuedecimal,maximumFractionDigits:t.valuedecimal})+" "+t.aYtxt):i.push("no data"),(e=t.ctxl2.measureText(i[s]).width+3*t.hintfpx)>l&&(l=e));for(;t.ctxl2.measureText(a).width<l&&!((a+=String.fromCharCode(9472)).length>20););t.ctxl2.beginPath(),t.hintmaxalpha&&(t.ctxl2.fillStyle=f(t.ctxl2.fillStyle,1)),t.ctxl2.fillStyle=v?t.hintfillhitcol:t.hintfillcol,t.ctxl2.textBaseline="top",t.ctxl2.textAlign="start",h=z+l+3*t.hintfpx>t.drr?z-3*t.hintfpx-l:z+2*t.hintfpx,r=w+t.hintfpx*(i.length+4+1)>t.drb?w-t.hintfpx*(i.length+4+1):w+2*t.hintfpx,t.ctxl2.lineWidth=t.hintframewidth,t.ctxl2.strokeStyle=t.hintrectcol,t.hintmaxalpha&&(t.ctxl2.fillStyle=f(t.ctxl2.fillStyle,1)),t.ctxl2.rect(h,r,l+t.hintfpx,t.hintfpx*(i.length+2+1)),t.ctxl2.stroke(),t.ctxl2.fillRect(h,r,l+t.hintfpx,t.hintfpx*(i.length+2+1)),t.ctxl2.fillStyle=t.hinttxtcol,t.ctxl2.textAlign="end",t.ctxl2.fillText(s,h+t.hintfpx/2+l,r+.5*t.hintfpx+0*t.hintfpx),t.ctxl2.fillText(a,h+t.hintfpx/2+l,r+.5*t.hintfpx+1*t.hintfpx);var n=0;for(let e=0;e<t.data.length;e++)"NO"!=d(t.style[e],"visible","---")?(t.ctxl2.beginPath(),b(e)?t.ctxl2.fillStyle=d(t.style[e],"linecolor",t.hintpointfill):t.ctxl2.fillStyle=d(t.style[e],"fillcolor",t.hintpointfill),t.hintmaxalpha&&(t.ctxl2.fillStyle=f(t.ctxl2.fillStyle,1)),t.ctxl2.strokeStyle="rgba(0,0,0,1)",t.ctxl2.lineWidth=t.hintcolfrwdth,t.ctxl2.rect(h+t.hintfpx/2,r+.5*t.hintfpx+t.hintfpx*(e-n+2),t.hintfpx,t.hintfpx),t.ctxl2.stroke(),t.ctxl2.beginPath(),t.ctxl2.fillRect(h+t.hintfpx/2,r+.5*t.hintfpx+t.hintfpx*(e-n+2),t.hintfpx,t.hintfpx),t.ctxl2.stroke(),t.ctxl2.fillStyle=t.hinttxtcol,t.ctxl2.textAlign="start",t.ctxl2.fillText(" ",h+2*t.hintfpx,r+.5*t.hintfpx+t.hintfpx*(e-n+2)),t.ctxl2.textAlign="end",t.ctxl2.fillText(i[e-n],h+t.hintfpx/2+l,r+.5*t.hintfpx+t.hintfpx*(e-n+2))):n++}if(t.XaxisLiveValue||t.YaxisLiveValue){t.ctxl2.font=t.descfontmod+t.descfpx+t.descfont;let e=2,s=0,h=0,r="";if(t.YaxisLiveValue&&(r=((t.zlvl-c)/(t.wght*t.dcorr*t.zcorr)-t.zoffs).toLocaleString(void 0,{useGrouping:t.dgroup,minimumFractionDigits:t.axisdecimalY,maximumFractionDigits:t.axisdecimalY}),h=t.ctxl2.measureText(r).width,h=t.ctxl2.measureText(i.toLocaleString(void 0,{useGrouping:t.dgroup,minimumFractionDigits:t.axisdecimalY,maximumFractionDigits:t.axisdecimalY})).width,(s=t.ctxl2.measureText(l.toLocaleString(void 0,{useGrouping:t.dgroup,minimumFractionDigits:t.axisdecimalY,maximumFractionDigits:t.axisdecimalY})).width)>h&&(h=s),t.ctxl2.beginPath(),t.ctxl2.textAlign="end",t.ctxl2.textBaseline="middle",t.ctxl2.fillStyle=t.liveValueback,t.ctxl2.fillRect(t.lvlv-t.aw-h-e,c-t.descfpx/2-e,1+h+2*e,t.descfpx+2*e),t.ctxl2.fillStyle=t.liveValueColor,t.ctxl2.fillText(r,t.lvlv-t.aw,c),t.ctxl2.stroke(),t.ctxl2.fill(),t.ctxl2.closePath()),t.XaxisLiveValue){let i=1;t.ctxl2.font=t.descfontmod+t.descfpx+t.descfont,h=s,t.zoom?(h=t.ctxl2.measureText(t.desc[t.from]).width,s=t.ctxl2.measureText(t.desc[t.to-1]).width):(h=t.ctxl2.measureText(t.desc[0]).width,s=t.ctxl2.measureText(t.desc[t.desc.length-1]).width),s>h&&(h=s),r=t.desc[o+t.from*t.zoom],t.ctxl2.beginPath(),t.ctxl2.save(),t.ctxl2.translate(t.drl,t.drb),t.ctxl2.rotate(-.5*Math.PI),i=a-t.lvlv,t.ctxl2.fillStyle=t.liveValueback,t.ctxl2.fillRect(t.drb-t.zlvl-t.marsize+e,i-t.descfpx/2-e+t.descfpx/2*(0==o)*!t.hmarshift,-(1+h+2*e),t.descfpx+2*e),t.ctxl2.restore(),t.ctxl2.fillStyle=t.liveValueColor,t.ctxl2.textAlign="end",t.ctxl2.textBaseline="middle",t.ctxl2.save(),t.ctxl2.textBaseline="middle",t.ctxl2.textAlign="end",t.ctxl2.translate(t.drl,t.drb),t.ctxl2.rotate(-.5*Math.PI),void 0!==r&&t.ctxl2.fillText(r.toLocaleString(void 0,{useGrouping:t.dgroup,minimumFractionDigits:t.axisdecimalX,maximumFractionDigits:t.axisdecimalX}),t.drb-t.zlvl-t.marsize,i+t.descfpx/2*(0==o)*!t.hmarshift),t.ctxl2.restore(),t.ctxl2.stroke(),t.ctxl2.fill(),t.ctxl2.closePath()}}}t.ctxl2.setLineDash([])}function L(i,l){var e=-1,s=!1,h=!1,o="",r=0,a=0,c=0,n=0,x=0;if(!t.islegend)return-1;if(0==t.legpos||2==t.legpos){c=0;for(let i=0;i<t.legstr.length;i++)void 0!==t.data[i]&&(c++,o+=t.legstr[i]);t.ctx.font=t.legfontmod+t.legpx+t.legfont,t.ctx.fillStyle=t.legtxtcol,n=(r=t.ctx.measureText(o).width+c*t.legpx*2.2-t.legpx)+0,x=(t.ctx.canvas.width-n)/2,a=0,0,a=(0==t.legpos?t.top-2*t.legpx-t.legframew-t.legmarg:t.bot+2*t.legframew+t.legmarg)+t.legpx/.8;let d=x+0;for(let o=0;o<t.data.length;o++){if(s=i>=d&&i<=d+1.2*t.legpx+t.ctx.measureText(t.legstr[o]).width+1,h=l>=a-t.legpx+1&&l<=a+1,s&&h&&(e=o),e>=0)return e;d+=1.2*t.legpx,d+=t.ctx.measureText(t.legstr[o]).width+1*t.legpx}}if(1==t.legpos||3==t.legpos){r=0;var d=0;c=0;for(let i=0;i<t.legstr.length;i++)d=t.ctx.measureText(t.legstr[i]).width,void 0!==t.data[i]&&(c++,d>r&&(r=d));n=r+2.2*t.legpx,x=0;let o=(x=1==t.legpos?t.rgt+t.legframew+t.legmarg:t.margh+t.legframew)+0;var f=(t.ctx.canvas.height-t.legpx*(t.legstr.length+1))/2+1.5*t.legpx;t.ctx.font=t.legfontmod+t.legpx+t.legfont,t.ctx.fillStyle=t.legtxtcol;for(let a=0;a<t.data.length;a++){if(t.ctx.fillStyle=t.legtxtcol,s=i>=o+t.legpx/2&&i<=o+t.legpx/2+r+1.2*t.legpx,h=l>f-t.legpx&&l<f,s&&h&&(e=a),e>=0)return e;f+=t.legpx}}return e}function X(i,l,e){if(null!=t.style&&void 0!==t.style&&!(i>t.style.length)&&null!=t.style[i]&&void 0!==t.style[i])if("---"!=d(t.style[i],l,"---")){for(let s=0;s<t.style[i].length;s++)if(t.style[i][s].indexOf(l)>=0){t.style[i][s]=l+"="+(e?"YES":"NO");break}}else t.style[i].push(l+"="+(e?"YES":"NO"))}function A(i){if(t.data.length<=0)return;if(t.hideonclick){var l=L(i.offsetX,i.offsetY);if(l>=0){switch(d(t.style[l],"visible","---")){case"---":X(l,"visible",!1);break;case"NO":X(l,"visible",!0),t.boldonover&&X(l,"boldover",!0);break;case"YES":X(l,"visible",!1)}return void t.redraw()}}if(1==t.pointclicked&&(t.pointclicked=!1,t.ctxl2.clearRect(0,0,t.layer2.width,t.layer2.height),(t.onmousemove||t.ontouchmove)&&D(i)),t.zoom&&i.shiftKey)return;let e=i.offsetX,s=i.offsetY,h=0;if(s>=t.drt-2*t.hintpointw&&s<=t.drb+2*t.hintpointw&&e>=t.drl-2*t.hintpointw&&e<=t.drr+2*t.hintpointw){if(h=Math.round((e-t.lvlv-t.hmarshift*(t.marhpx/2))/(t.marhpx/t.xdiv)),isNaN(h)||h<0||h>t.datalength)return;let l=2*t.hintpointw,o=t.lvlv+h*t.marhpx/t.xdiv+t.hmarshift*(t.marhpx/2),r=t.marhpx*t.barperc/t.barcnt,a=t.marhpx*t.barperc/2-r/2,c=0,n=0,x=0;for(let m=0;m<t.data.length;m++)if(void 0!==t.data[m]&&(x=t.zlvl-(t.data[m][h+t.from*t.zoom]+t.zoffs)*t.wght*t.dcorr*t.zcorr,n=o,u(m)&&(n=n-a+r*(++c-1)),Math.abs(n-e)<l&&Math.abs(x-s)<l)){if("NO"==d(t.style[m],"visible","---"))continue;M||(t.pointclicked=!0);let l=t.axisXtxt+" ["+t.desc[h+t.from*t.zoom].toLocaleString(void 0,{useGrouping:t.dgroup,minimumFractionDigits:t.axisdecimalX,maximumFractionDigits:t.axisdecimalX})+"] = "+(t.data[m][h+t.from*t.zoom]*t.dcorr).toLocaleString(void 0,{useGrouping:t.dgroup,minimumFractionDigits:t.valuedecimal,maximumFractionDigits:t.valuedecimal})+" "+t.aYtxt;t.ctxl2.font=t.hintfontmod+t.hintfpx+t.hintfont;let e=t.ctxl2.measureText(l).width;e+=2*t.hintfpx,t.ctxl2.clearRect(0,0,t.layer2.width,t.layer2.height),t.ctxl2.setLineDash([]),t.ctxl2.beginPath(),t.ctxl2.fillStyle=t.hintfillcol,t.ctxl2.textBaseline="top",t.ctxl2.textAlign="start";let s=!1,o=!1,r=0,a=0;i.offsetX+e+2.5*t.hintfpx>t.drr?(r=i.offsetX-3*t.hintfpx-e,s=!0):r=i.offsetX+2*t.hintfpx,i.offsetY+3*t.hintfpx+t.hintframewidth>t.drb?(a=i.offsetY-3*t.hintfpx,o=!0):a=i.offsetY+2*t.hintfpx,t.ctxl2.lineWidth=t.hintframewidth,t.ctxl2.strokeStyle=t.hintrectcol,t.ctxl2.rect(r,a,e+.5*t.hintfpx,2*t.hintfpx),t.ctxl2.stroke(),t.hintmaxalpha&&(t.ctxl2.fillStyle=f(t.ctxl2.fillStyle,1)),t.ctxl2.fillRect(r,a,e+.5*t.hintfpx,2*t.hintfpx),t.ctxl2.fillStyle=t.hinttxtcol,t.ctxl2.beginPath(),b(m)?t.ctxl2.fillStyle=d(t.style[m],"linecolor",t.hintpointfill):t.ctxl2.fillStyle=d(t.style[m],"fillcolor",t.hintpointfill),t.hintmaxalpha&&(t.ctxl2.fillStyle=f(t.ctxl2.fillStyle,1)),t.ctxl2.strokeStyle="rgba(0,0,0,1)",t.ctxl2.lineWidth=t.hintcolfrwdth,t.ctxl2.rect(r+t.hintfpx/2,a+t.hintfpx/2,t.hintfpx,t.hintfpx),t.ctxl2.stroke(),t.ctxl2.beginPath(),t.ctxl2.fillRect(r+t.hintfpx/2,a+t.hintfpx/2,t.hintfpx,t.hintfpx),t.ctxl2.stroke(),t.ctxl2.strokeStyle=t.hinttxtcol,t.ctxl2.fillStyle=t.hinttxtcol,t.hintmaxalpha&&(t.ctxl2.fillStyle=f(t.ctxl2.fillStyle,1)),t.ctxl2.textAlign="end",t.ctxl2.fillText(l,r+0*t.hintfpx+e,a+.5*t.hintfpx),t.ctxl2.lineWidth=t.hintlinetoMwidth,t.ctxl2.strokeStyle=t.hintlinetoMcol,t.ctxl2.beginPath(),t.ctxl2.arc(n,x,t.hintpointw,0,2*Math.PI),t.crlinetosmallhint&&t.ctxl2.moveTo(r+(e+.5*t.hintfpx)*s,a+2*t.hintfpx*o),t.ctxl2.lineTo(n,x),t.ctxl2.stroke();break}}}let B=null,F=null,W=!1,E=!1,C=!1;function R(i){let l=z,e=w;if(e>=t.drt&&e<=t.drb&&l>=t.drl&&l<=t.drr&&1==T){t.repeatMousePer=W?t.repeatPerSpeed:t.repeatPerSlow,F=setTimeout(R,t.repeatMousePer);let i=t.LRsize*t.drv;l-t.drl<i&&t.left(),t.drr-l<i&&t.right(),D(B),C=!0}return!1}var _=0,N=0;if(0==this.eventsactivated&&(this.onmouseclick&&this.ctxl2.canvas.addEventListener("click",A,!0),this.onmousemove&&this.ctxl2.canvas.addEventListener("mousemove",D,!0),this.ontouchmove&&this.ctxl2.canvas.addEventListener("touchmove",D,!0),this.onmousedown&&this.ctxl2.canvas.addEventListener("mousedown",function(i){if(3==i.buttons&&(t.hintwithctrl=!t.hintwithctrl),t.multimsdown&&2==i.buttons&&i.shiftKey&&!i.ctrlKey&&!i.altKey){console.log("ev.buttons="+i.buttons);var l=(new Date).getTime();l-_>t.multimstout&&(N=0,_=l),++N>=t.multimsdowncnt&&(N=0,_=0,t.allpoints=!t.allpoints,t.draw())}k=!0,T=i.buttons;let e=i.offsetX,s=i.offsetY,h=0;if(s>=t.drt&&s<=t.drb&&e>=t.drl&&e<=t.drr&&1==T){if(h=Math.round((e-t.lvlv-t.hmarshift*(t.marhpx/2))/(t.marhpx/t.xdiv)),isNaN(h)||h<0||h>=t.datalength)return!1;if(t.mouseclickLR&&!i.shiftKey){let l=t.hintpointw,o=t.lvlv+h*t.marhpx/t.xdiv+t.hmarshift*(t.marhpx/2),r=t.marhpx*t.barperc/t.barcnt,a=t.marhpx*t.barperc/2-r/2,c=0,n=0,x=0;for(let i=0;i<t.data.length;i++)if(void 0!==t.data[i]&&(x=t.zlvl-t.data[i][h+t.from*t.zoom]*t.wght*t.dcorr*t.zcorr,n=o,u(i)&&(n=n-a+r*(++c-1)),Math.abs(n-e)<l&&Math.abs(x-s)<l))return;let d=t.LRsize*t.drv;e-t.drl<d&&t.left(),t.drr-e<d&&t.right(),t.repeatMouseMode&&(e-t.drl<d||t.drr-e<d)&&(0!=i.offsetX&&0!=i.offsetY&&(B=i),F=setTimeout(R,t.repeatPerDelay))}i.shiftKey&&(t.lvlv,t.marhpx,t.xdiv,t.hmarshift,t.marhpx,y=h+t.from,S=y)}return D(i),!1},!0),this.onmouseup&&this.ctxl2.canvas.addEventListener("mouseup",function(i){return clearInterval(F),C=!1,B=null,k=!1,1==T&&i.shiftKey&&(y==S||S+1<=y||(t.from=y,t.to=S+1,t.zoom=!0,t.draw())),T=i.buttons,D(i),!1},!0),this.onkeydown&&this.ctxl2.canvas.addEventListener("keydown",function(i){switch(W=i.ctrlKey,E=i.shiftKey,event.key){case"ArrowLeft":t.revarrowkeysinzoom?t.right():t.left(),i.preventDefault&&i.preventDefault();break;case"ArrowRight":t.revarrowkeysinzoom?t.left():t.right(),i.preventDefault&&i.preventDefault();break;case"ArrowUp":t.home(),i.preventDefault&&i.preventDefault();break;case"ArrowDown":t.end(),i.preventDefault&&i.preventDefault();break;case"Home":t.home(),i.preventDefault&&i.preventDefault();break;case"End":t.end(),i.preventDefault&&i.preventDefault();break;case"Escape":t.undozoom(),i.preventDefault&&i.preventDefault()}return D(i),!1},!0),this.onkeyup&&this.ctxl2.canvas.addEventListener("keyup",function(i){return W=i.ctrlKey,E=i.shiftKey,W||!t.hintwithctrl||C||t.ctxl2.clearRect(0,0,t.ctxl2.canvas.width,t.ctxl2.canvas.height),i.shiftKey||(y=0,S=0),!1},!0),this.oncontext&&this.ctxl2.canvas.addEventListener("contextmenu",function(i){var l,e,s;(i=i||window.ev).stopPropagation&&i.stopPropagation(),i.preventDefault&&i.preventDefault(),i.cancelBubble=!0,i.returnValue=!1,i.altKey&&!i.ctrlKey&&t.downloadChartEnable&&(l=t.download_png_fname,e=t.ctx.canvas.toDataURL("image/png",1).replace("image/png","image/octet-stream"),(s=document.createElement("a")).setAttribute("download",l),s.setAttribute("href",e),s.click(),s.remove()),i.altKey&&i.ctrlKey&&function(i){var l=t.download_csv_listsep,e=t.axisXtxt;for(let i=0;i<t.data.length;i++)void 0!==t.legstr[i]?e+=l+t.legstr[i]:e+=l+"series_"+(i+1).toString();e+="\n";for(let i=0;i<t.desc.length;i++){e+=t.desc[i];for(let s=0;s<t.data.length;s++)null!=t.data[s]&&void 0!==t.data[s]&&null!=t.data[s][i]&&void 0!==t.data[s][i]?e+=l+t.data[s][i].toLocaleString():e+=l;e+="\n"}var s=document.createElement("a");s.setAttribute("href","data:text/csv;charset=utf-8,"+encodeURI(e)),s.setAttribute("download",i),s.click(),s.remove()}(t.download_csv_fname)},!1),this.ctxl2.canvas.setAttribute("tabindex",0),this.ctxl2.canvas.focus(),(this.onmouseclick||this.onmousemove||this.ontouchmove)&&this.ctxl2.canvas.addEventListener("mouseout",function(){t.ctxl2.clearRect(0,0,t.ctxl2.canvas.width,t.ctxl2.canvas.height),t.pointclicked=!1,t.oldMouseEv=null,z=0,w=0,k=!1,T=0,P=-1,M=!1},!0),this.eventsactivated=!0),this.datalength=this.alldatalength,this.wght=0,this.barcnt=0,this.barnr=0,this.marhpx=0,i=1/0,l=-1/0,Array.isArray(this.data))for(let s=0;s<this.data.length;s++)void 0!==this.data[s]&&(u(s)&&(t.barcnt++,t.hmarshift=!0),this.Yzoom&this.YonlyVisiblescale&"NO"==d(this.style[s],"visible","---")||((e=n(this.data[s])).min<i&&(i=e.min),e.max>l&&(l=e.max)));i==1/0&&(i=0),l==-1/0&&(l=0),this.Yzoom&&0==this.Ymax&&0!=this.Ymin&&(this.Yzoom=!1),this.Yzoom&&0!=this.Ymax&&0==this.Ymin&&(this.Yzoom=!1),l>0&&i>0&&!this.Yzoom&&(i=0),l<0&&i<0&&!this.Yzoom&&(l=0),this.Ymax<=this.Ymin&&(this.Ymax=0,this.Ymin=0);let I=!0;if((this.from<0||this.from>this.alldatalength)&&(I=!1),(this.to<0||this.to>this.alldatalength)&&(I=!1),this.to-this.from<2&&(I=!1),I||(this.from=0,this.to=this.alldatalength,this.datalength=this.alldatalength,this.zoom=!1),0!=this.Ymax&&(l=this.Ymax),0!=this.Ymin&&(i=this.Ymin),this.zoffs=0,this.zcorr=1,this.Yzoom&&l>0&&i>0&&(this.zoffs=-i,this.zcorr=l/(l-i)),this.Yzoom&&l<0&&i<0&&(this.zoffs=-l,this.zcorr=Math.abs(i)/(Math.abs(i)-Math.abs(l))),(this.axisdecimalX<0||this.axisdecimalX>3)&&(this.axisdecimalX=1),(this.axisdecimalY<0||this.axisdecimalY>3)&&(this.axisdecimalY=1),(this.valuedecimal<0||this.valuedecimal>5)&&(this.valuedecimal=0),void 0===this.desc||null==this.desc||0==this.desc||0==this.desc.length){this.desc=[];for(let t=0;t<this.datalength;t++)this.desc.push(t+1)}for(let t=0;t<this.desc.length;t++)void 0!==this.desc[t]&&null!=this.desc[t]||(this.desc[t]="");this.ctx.beginPath(),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.fillStyle=this.canvasbkcol,this.ctx.lineWidth=this.canvasfrw,this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.stroke(),this.ctx.closePath(),this.legend(),this.ctx.strokeStyle=this.canvasfrcol,this.drawzfrm&&(this.ctx.beginPath(),this.ctx.rect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.stroke(),this.ctx.closePath()),this.ctx.lineWidth=1,this.ctx.font=this.descfontmod+this.descfpx+this.descfont,this.ctx.lineCap="round",this.ctx.lineJoin="miter",this.ctx.miterLimit=1,this.ctxl2.lineWidth=1,this.ctxl2.font=this.descfontmod+this.descfpx+this.descfont,this.ctxl2.lineCap="round",this.ctxl2.lineJoin="miter",this.ctxl2.miterLimit=1,this.aYtxt=t.axisYtxt.toString();let V=Math.abs(Math.max(Math.abs(l),Math.abs(i)));if(V*Math.pow(10,this.valuedecimal)<1){let e=1,s=0;if(V>0)for(;V*e<10&&(e*=10,!(++s>10)););s>0&&(this.aYtxt="*(10^-"+s+")"+t.axisYtxt.toString(),i*=e,l*=e,this.dcorr=e),0==this.valuedecimal&&(this.valuedecimal=2)}if((V=Math.abs(Math.max(Math.abs(l),Math.abs(i))))>this.bigmax){let e=1,s=0;for(;V/e>this.bigmax&&(e*=10,!(++s>10)););s>0&&(this.aYtxt="*(10^"+s+")"+t.axisYtxt.toString(),i/=e,l/=e,this.dcorr=1/e),this.valuedecimal=0}this.zoom?this.datalength=this.to-this.from:this.datalength=this.alldatalength,l>=0&&0==i&&(this.zerox=0),i<0&&0==l&&(this.zerox=this.drb-this.drt),l>0&&i<0&&(this.zerox=Math.abs(i/(l-i)*this.drv)),this.zlvl=this.drb-this.zerox,0==this.datalength&&(this.zlvl=this.drb);let G=0,K=0;for(let t=this.from*this.zoom;t<this.desc.length;t++)(K=this.ctx.measureText(this.desc[t].toLocaleString(void 0,{useGrouping:this.dgroup,minimumFractionDigits:this.axisdecimalX,maximumFractionDigits:this.axisdecimalX})).width)>G&&(G=K);this.drawXdesc||(G=0),this.drb-this.zlvl<G&&(this.drb=this.bot-this.marsize/2-G-this.descfpx/2,this.drv=this.drb-this.drt,l>0&&i<0?this.zerox=Math.abs(i/(l-i)*this.drv):l>=0?this.zerox=0:i<0&&(this.zerox=this.drb-this.drt),this.zlvl=this.drb-this.zerox),this.marpl=Math.round(Math.abs((this.zlvl-this.drt)/this.descfpx)),this.marmi=Math.round(Math.abs((this.drb-this.zlvl)/this.descfpx)),this.marall=this.marpl+this.marmi,s=x(l-(i>0?i*this.Yzoom:0),this.marpl),this.marpl=s.cnt,a=s.value,h=x(i-(l<0?l*this.Yzoom:0),this.marmi),this.marmi=h.cnt,c=h.value,this.marpx=Math.abs((this.zlvl-this.drt)/this.marpl),this.marmx=Math.abs((this.drb-this.zlvl)/this.marmi),this.marax=Math.max(this.marpx,this.marmx),this.marpx=this.marax,this.marmx=this.marax,a>c&&(c=a),c>a&&(a=c),this.marpl=Math.floor(Math.abs((this.zlvl-this.drt)/this.marax)),this.marmi=Math.floor(Math.abs((this.drb-this.zlvl)/this.marax)),this.marall=this.marpl+this.marmi;let O=this.ctx.measureText(l.toLocaleString(void 0,{useGrouping:this.dgroup,minimumFractionDigits:this.axisdecimalY,maximumFractionDigits:this.axisdecimalY})).width+this.descfpx,j=this.ctx.measureText(i.toLocaleString(void 0,{useGrouping:this.dgroup,minimumFractionDigits:this.axisdecimalY,maximumFractionDigits:this.axisdecimalY})).width+this.descfpx;this.drawYdesc||(O=0,j=0);let H=this.lft+this.marsize*this.drawmark/2+Math.max(O,j);if(H>this.lvlv&&(this.lvlv=H,this.drl=this.lvlv),o=this.rotdescX?Math.round(Math.abs((this.lvlv-this.drr)/this.descfpx))+1:Math.round(Math.abs((this.lvlv-this.drr)/G))+1,this.marxdata=function(t,i){let l=t,e=1,s=1;do{if(e=1,(l=Math.abs(t/(e*s)))<=i)break;if(e=2,(l=Math.abs(t/(e*s)))<=i)break;if(e=5,(l=Math.abs(t/(e*s)))<=i)break;s*=10}while(l>i);return{cnt:l,div:e*s}}(this.datalength-0,o),o=this.marxdata.cnt,this.xdiv=this.marxdata.div,r=Math.min(this.datalength-1,o)+1*this.hmarshift,this.marhpx=(this.drr-this.lvlv)/r,this.chartzone&&(this.ctx.strokeStyle=this.chartzonecol,this.ctx.rect(this.lft,this.top,this.rgt-this.lft,this.bot-this.top),this.ctx.stroke()),this.drawzone&&(this.ctx.strokeStyle=this.drwfracol,this.ctx.fillStyle=this.drwfilcol,this.ctx.beginPath(),this.drawzfrm&&this.ctx.rect(this.drl,this.drt,this.drr-this.drl,this.drb-this.drt),this.ctx.fillRect(this.drl,this.drt,this.drr-this.drl,this.drb-this.drt),this.ctx.stroke()),this.drawmesh){this.ctx.lineWidth=this.meshlw,this.ctx.strokeStyle=this.mshcol,this.ctx.fillStyle=this.mshcol,this.meshframe&&(this.ctx.rect(this.drl,this.drt,this.drr-this.drl,this.drb-this.drt),this.ctx.stroke());let t=0,i=this.zlvl-t*this.marpx;for(;i>=this.drt;)this.ctx.beginPath(),this.ctx.moveTo(this.lvlv,this.zlvl-t*this.marpx),this.ctx.lineTo(this.drr,this.zlvl-t*this.marpx),this.ctx.stroke(),t++,i=this.zlvl-t*this.marpx;for(t=1,i=this.zlvl+t*this.marmx;i<=this.drb;)this.ctx.beginPath(),this.ctx.moveTo(this.lvlv,this.zlvl+t*this.marmx),this.ctx.lineTo(this.drr,this.zlvl+t*this.marmx),t++,i=this.zlvl+t*this.marmx,this.ctx.stroke()}if(this.drawmesh){this.ctx.strokeStyle=this.mshcol,this.ctx.fillStyle=this.mshcol;let t=0;t=1*this.hmarshift,this.meshframe&&(t=1);let i=0;for(i=this.lvlv+t*this.marhpx-this.hmarshift*(this.marhpx/2);i<=this.drr&&!(t>r);)this.ctx.beginPath(),this.ctx.moveTo(i,this.drt),this.ctx.lineTo(i,this.drb),this.ctx.stroke(),t++,i=this.lvlv+t*this.marhpx-this.hmarshift*(this.marhpx/2)}if(this.vsOn&&this.zoom){let t=this.top+this.al;this.vzonXaxis&&(t=this.zlvl);let i=this.ctx;i.lineCap="round",i.lineJoin="miter",i.miterLimit=1,i.strokeStyle=f(this.vzcolor,this.vzalpha),i.fillStyle=this.vzcolor,i.lineWidth=this.vzwdtsm,i.beginPath(),i.moveTo(this.drl,t),i.lineTo(this.drr,t),i.stroke();let l=(this.drr-this.drl)/this.alldatalength;i.lineWidth=this.vzwdtlg,i.beginPath(),i.moveTo(this.drl+this.from*l,t),i.lineTo(this.drl+this.to*l,t),i.stroke(),i.closePath()}if(this.drawmark||this.drawYdesc){this.ctx.lineWidth=this.marw,this.ctx.strokeStyle=this.descol,this.ctx.fillStyle=this.descol,this.ctx.textBaseline="middle",this.ctx.textAlign="end";let t=0,e=0,s=!1;if(l>0)for(t=1*!this.drw0y,s=!0,e=this.zlvl-t*this.marpx;e>=this.drt;){if(this.ctx.beginPath(),this.drawmark&&(this.ctx.moveTo(this.lvlv-this.marsize/2,e),this.ctx.lineTo(this.lvlv+this.marsize/2,e)),this.drawYdesc){let l=i>0&&this.Yzoom?i:0;this.ctx.fillText((l+t*a).toLocaleString(void 0,{useGrouping:this.dgroup,minimumFractionDigits:this.axisdecimalY,maximumFractionDigits:this.axisdecimalY}),this.lvlv-this.marsize,e)}t++,e=this.zlvl-t*this.marpx,this.ctx.stroke()}if(i<0)for(t=s?1:1*!this.drw0y,e=this.zlvl+t*this.marmx;e<=this.drb;){if(this.ctx.beginPath(),this.ctx.moveTo(this.lvlv-this.marsize/2,e),this.ctx.lineTo(this.lvlv+this.marsize/2,e),this.drawYdesc){let i=l<0&&this.Yzoom?l:0;this.ctx.fillText((i-t*c).toLocaleString(void 0,{useGrouping:this.dgroup,minimumFractionDigits:this.axisdecimalY,maximumFractionDigits:this.axisdecimalY}),this.lvlv-this.marsize,e)}t++,e=this.zlvl+t*this.marmx,this.ctx.stroke()}}if(this.drawmark||this.drawXdesc){this.ctx.lineWidth=this.marw,this.ctx.strokeStyle=this.descol,this.ctx.fillStyle=this.descol,this.ctx.textBaseline="top",this.ctx.textAlign="center";let t=1;if(o>0){t=t+1*!this.drw0x-this.hmarshift;let i=this.lvlv+t*this.marhpx+this.hmarshift*(this.marhpx/2);for(;i<=this.drr&&!(t>r);){if(this.ctx.beginPath(),this.drawmark&&(this.ctx.moveTo(i,this.zlvl-this.marsize/2),this.ctx.lineTo(i,this.zlvl+this.marsize/2)),this.drawXdesc)if(this.rotdescX){this.ctx.save(),this.ctx.textBaseline="middle",this.ctx.textAlign="end",this.ctx.translate(this.drl,this.drb),this.ctx.rotate(-.5*Math.PI);let i=t*this.marhpx+this.hmarshift*(this.marhpx/2);void 0!==this.desc[t*this.xdiv+this.from*this.zoom]&&this.ctx.fillText(this.desc[t*this.xdiv+this.from*this.zoom].toLocaleString(void 0,{useGrouping:this.dgroup,minimumFractionDigits:this.axisdecimalX,maximumFractionDigits:this.axisdecimalX}),this.drb-this.zlvl-this.marsize,i+this.descfpx/2*(0==t)*!this.hmarshift),this.ctx.restore()}else void 0!==this.desc[t*this.xdiv]&&this.ctx.fillText(this.desc[t*this.xdiv+this.from*this.zoom],i-(0==t)*this.descfpx/2,this.zlvl+this.marsize);t++,i=this.lvlv+t*this.marhpx+this.hmarshift*(this.marhpx/2),this.ctx.stroke()}}}if(this.drawaxis){if(this.ctx.strokeStyle=this.axcol,this.ctx.fillStyle=this.axcol,this.ctx.lineWidth=this.axw,this.ctx.font=this.descfontmod+this.descfpx+this.descfont,this.ctx.beginPath(),this.ctx.moveTo(this.lvlv,this.zlvl),this.ctx.lineTo(this.rgt-3*this.axw*this.drawarrow,this.zlvl),this.ctx.moveTo(this.lvlv,this.bot-(this.bot-this.drb)/2),this.ctx.lineTo(this.lvlv,this.top+3*this.axw*this.drawarrow),this.ctx.stroke(),this.drawarrow&&(this.ctx.beginPath(),this.ctx.lineTo(this.rgt,this.zlvl),this.ctx.lineTo(this.rgt-this.al,this.zlvl-this.aw/2),this.ctx.lineTo(this.rgt-this.al,this.zlvl+this.aw/2),this.ctx.lineTo(this.rgt,this.zlvl),this.ctx.fillStyle=this.axcol,this.ctx.moveTo(this.lvlv,this.top),this.ctx.lineTo(this.lvlv-this.aw/2,this.top+this.al),this.ctx.lineTo(this.lvlv+this.aw/2,this.top+this.al),this.ctx.lineTo(this.lvlv,this.top),this.ctx.fillStyle=this.axcol,this.ctx.fill()),this.ctx.beginPath(),this.axisXdesc){this.ctx.fillStyle=this.axdesccol;let i=this.ctx.measureText(t.axisXtxt).width;if(i+this.drr+this.descfpx/2>this.rgt){this.ctx.textBaseline="top",this.ctx.textAlign="end";let l=0;i+this.descfpx>this.drb-this.zlvl&&(this.ctx.textAlign="start",l=2*this.descfpx),this.ctx.save(),this.ctx.translate(this.drr,this.zlvl),this.ctx.rotate(-.5*Math.PI),this.ctx.fillText(t.axisXtxt,-this.descfpx+l,.5*this.descfpx),this.ctx.restore()}else this.ctx.textAlign="start",this.ctx.textBaseline="top",this.ctx.fillText(t.axisXtxt,this.drr+this.descfpx/2,this.zlvl+this.descfpx/2)}this.axisYdesc&&(this.ctx.textAlign="start",this.ctx.textBaseline="middle",this.ctx.fillStyle=this.axdesccol,this.ctx.fillText(this.aYtxt,this.lvlv+this.aw/1,this.top+this.al/2))}!function(){if(void 0!==t.style)for(let i=0;i<t.data.length;i++)void 0!==t.style[i]&&("NO"!=d(t.style[i],"visible","")?"line"==d(t.style[i],"type","")?m(t.data[i],t.style[i]):"area"==d(t.style[i],"type","")?g(t.data[i],t.style[i]):"bar"==d(t.style[i],"type","")?v(t.data[i],t.style[i]):"stairs"==d(t.style[i],"type","")&&p(t.data[i],t.style[i]):u(i)&&t.barnr++)}(),D(null)}}